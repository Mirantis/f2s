id: primary-mongo
resources:
- id: role_data#{index}#
  from: fuel_resources/role_data
  location: '#{node}#'
  values:
    env: '#{env}#'
    puppet_modules: /etc/puppet/modules
    uid: '#{index}#'
    puppet_modules: '/etc/puppet/modules'
- id: fuel_pkgs#{index}#
  from: fuel_resources/fuel_pkgs
  location: '#{node}#'
  values_from: role_data#{index}#
- id: logging#{index}#
  from: fuel_resources/logging
  location: '#{node}#'
  values_from: role_data#{index}#
- id: tools#{index}#
  from: fuel_resources/tools
  location: '#{node}#'
  values_from: role_data#{index}#
- id: netconfig#{index}#
  from: fuel_resources/netconfig
  location: '#{node}#'
  values_from: role_data#{index}#
- id: connectivity_tests#{index}#
  from: fuel_resources/connectivity_tests
  location: '#{node}#'
  values_from: role_data#{index}#
- id: firewall#{index}#
  from: fuel_resources/firewall
  location: '#{node}#'
  values_from: role_data#{index}#
- id: ssl-keys-saving#{index}#
  from: fuel_resources/ssl-keys-saving
  location: '#{node}#'
  values_from: role_data#{index}#
- id: ssl-add-trust-chain#{index}#
  from: fuel_resources/ssl-add-trust-chain
  location: '#{node}#'
  values_from: role_data#{index}#
- id: hosts#{index}#
  from: fuel_resources/hosts
  location: '#{node}#'
  values_from: role_data#{index}#
- id: top-role-primary-mongo#{index}#
  from: fuel_resources/top-role-primary-mongo
  location: '#{node}#'
  values_from: role_data#{index}#
events:
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: fuel_pkgs#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: logging#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: tools#{index}#.run
- type: depends_on
  state: success
  parent_action: logging#{index}#.run
  child_action: tools#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: netconfig#{index}#.run
- type: depends_on
  state: success
  parent_action: tools#{index}#.run
  child_action: netconfig#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: connectivity_tests#{index}#.run
- type: depends_on
  state: success
  parent_action: netconfig#{index}#.run
  child_action: connectivity_tests#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: firewall#{index}#.run
- type: depends_on
  state: success
  parent_action: netconfig#{index}#.run
  child_action: firewall#{index}#.run
- type: depends_on
  state: success
  parent_action: connectivity_tests#{index}#.run
  child_action: firewall#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: ssl-keys-saving#{index}#.run
- type: depends_on
  state: success
  parent_action: firewall#{index}#.run
  child_action: ssl-keys-saving#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: ssl-add-trust-chain#{index}#.run
- type: depends_on
  state: success
  parent_action: firewall#{index}#.run
  child_action: ssl-add-trust-chain#{index}#.run
- type: depends_on
  state: success
  parent_action: ssl-keys-saving#{index}#.run
  child_action: ssl-add-trust-chain#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: hosts#{index}#.run
- type: depends_on
  state: success
  parent_action: netconfig#{index}#.run
  child_action: hosts#{index}#.run
- type: depends_on
  state: success
  parent_action: connectivity_tests#{index}#.run
  child_action: hosts#{index}#.run
- type: depends_on
  state: success
  parent_action: ssl-add-trust-chain#{index}#.run
  child_action: hosts#{index}#.run
- type: depends_on
  state: success
  parent_action: role_data#{index}#.run
  child_action: top-role-primary-mongo#{index}#.run
- type: depends_on
  state: success
  parent_action: firewall#{index}#.run
  child_action: top-role-primary-mongo#{index}#.run
- type: depends_on
  state: success
  parent_action: hosts#{index}#.run
  child_action: top-role-primary-mongo#{index}#.run
